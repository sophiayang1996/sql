select a,b
from (select a,b, rank() over(partition by group order by a) ra
  from db)
 where ra<= N
